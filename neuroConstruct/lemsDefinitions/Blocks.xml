<Lems xmlns="http://www.neuroml.org/lems/0.7.1"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.neuroml.org/lems/0.7.1
			  ../../LEMS/Schemas/LEMS/LEMS_v0.7.1.xsd">

  <Include file="NeuroMLCoreDimensions.xml"/>
  <Include file="Synapses.xml"/>

  <ComponentType name="dummyBlockMechanism"
		 extends="baseBlockMechanism">
    <Dynamics>
      <StateVariable name="blockFactor" dimension="none" exposure="blockFactor"/>
      <OnStart>
	<StateAssignment variable="blockFactor" value="1"/>
      </OnStart>
    </Dynamics>
  </ComponentType>


  <ComponentType name="voltageDepFermiBlockMechanism"
		 extends="baseBlockMechanism"
		 description="Synaptic blocking mechanism which varies with a Fermi function-like dependence on the membrane voltage, e.g. in NMDA receptor mediated synapses">

    <Parameter name="voltageScale" dimension="voltage"/>
    <Parameter name="voltageHalfBlock" dimension="voltage" />

    <Requirement name="v" dimension="voltage"/>

    <Dynamics>
      <DerivedVariable name="blockFactor" dimension="none" exposure="blockFactor" value="1/(1 + exp(-1 * ((v - voltageHalfBlock)/ voltageScale)))" />
    </Dynamics>

  </ComponentType>


  <ComponentType name="RothmanBlockMechanism"
    extends="baseBlockMechanism"
    description="Synaptic blockage model used for the NMDA-mediated
		 synapse in Schwartz2012.">

    <Parameter name="z" dimension="none"/>
    <!--<Parameter name="T" dimension="temperature"/>-->
    <Parameter name="blockConcentration" dimension="concentration"/>
    <Parameter name="deltaBind" dimension="none"/>
    <Parameter name="deltaPerm" dimension="none"/>
    <Parameter name="C1" dimension="concentration"/>
    <Parameter name="C2" dimension="concentration"/>

    <Constant name="faradayConstant" dimension="charge_per_mole"
	      value="96485.3365 C_per_mol"/>
    <Constant name="idealGasConstant" dimension="idealGasConstantDims"
	      value="8.3144621 J_per_K_per_mol"/>

    <Requirement name="v" dimension="voltage"/>
    <Requirement name="temperature" dimension="temperature"/>

    <Text name="species"/>

    <Dynamics>
      <DerivedVariable name="theta" dimension="per_voltage" value="(z * faradayConstant) / (idealGasConstant * temperature)"/>
      <DerivedVariable name="blockFactor" dimension="none" exposure="blockFactor" value="(C1 * exp(deltaBind * theta * v) + C2 * exp(-deltaPerm * theta * v)) / (C1 * exp(deltaBind * theta * v) + C2 * exp(-deltaPerm * theta * v) + blockConcentration * exp(-deltaBind * theta * v))"/>
    </Dynamics>
  </ComponentType>



</Lems>
